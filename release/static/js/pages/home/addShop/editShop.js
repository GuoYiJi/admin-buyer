global.webpackJsonp([65],{YhMY:function(t,e){},h61u:function(t,e,s){"use strict";var a=s("wAH5"),i=s("nJ3x");var o=function(t){s("YhMY")},n=s("ybqe")(a.a,i.a,o,"data-v-633a441e",null);e.a=n.exports},nJ3x:function(t,e,s){"use strict";var a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home"},[s("div",{staticClass:"add_video"},[s("p",{staticClass:"a_title"},[t._v("请添加视频: (最多可添加1个)")]),t._v(" "),s("div",{staticClass:"v_box"},[t.videoSrc?s("div",{staticClass:"add"},[s("video",{attrs:{src:t.videoSrc,"show-play-btn":"false",objectFit:"fill",controls:"false"}})]):t._e(),t._v(" "),s("div",{staticClass:"add",attrs:{eventid:"0"},on:{tap:t.bindButtonTap}},[t.videoSrc?s("p",[t._v("更换视频")]):s("p",[t._v("+视频")])],1)])],1),t._v(" "),s("p",{staticClass:"a_title"},[t._v("请添加图片:(最多可添加15张)")]),t._v(" "),s("div",{staticClass:"add_image"},[s("div",{staticClass:"add_image__bd"},[t._l(t.imageList,function(e,a){return s("div",{key:a,staticClass:"uploader__file"},[s("div",{staticClass:"uploader__file-inner"},[s("div",{staticClass:"add",style:{backgroundImage:"url("+e+")"}},[s("i",{staticClass:"cancel_shop",attrs:{eventid:"1-"+a},on:{click:function(e){t.toCancel(a)}}})],1)])])}),t._v(" "),s("div",{staticClass:"uploader__file"},[s("div",{staticClass:"uploader__file-inner"},[s("div",{staticClass:"addBtn",attrs:{eventid:"2"},on:{tap:t.bindButtonTapImage}},[s("p",[t._v("+图片")])],1)])])],2)]),t._v(" "),s("div",{staticClass:"line-box"}),t._v(" "),s("div",{staticClass:"van-cell-group van-hairline--top-bottom"},[s("div",{staticClass:"van-cell van-field"},[s("div",{staticClass:"van-cell__title"},[t._v("商品标题")]),t._v(" "),s("div",{staticClass:"van-cell__value"},[s("div",{staticClass:"van-field__body"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.goods.name,expression:"goods.name"}],staticClass:"van-field__control",attrs:{placeholder:"输入商品标题",type:"text",eventid:"3"},domProps:{value:t.goods.name},on:{input:function(e){e.target.composing||(t.goods.name=e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"van-cell van-cell--clickable",attrs:{eventid:"4"},on:{click:function(e){t.toOpen("showMarket")}}},[s("div",{staticClass:"van-cell__title"},[t._v("市场档口")]),t._v(" "),s("div",{staticClass:"van-cell__value"},[s("span",{staticClass:"van-ellipsis"},[t._v(t._s(t.goods.stallInfo1?t.goods.stallInfo1+"-"+t.goods.stallInfo2+"-"+t.goods.stallInfo3:"请选择市场档口"))])]),t._v(" "),s("i",{staticClass:"van-icon van-icon-arrow van-cell__right-icon"})],1),t._v(" "),s("div",{staticClass:"van-cell van-cell--clickable",attrs:{eventid:"5"},on:{click:function(e){t.toRoute("home/addShop/buyDesc",{id:t.shopExplan.id})}}},[s("div",{staticClass:"van-cell__title"},[t._v("采购说明")]),t._v(" "),s("div",{staticClass:"van-cell__value"},[s("span",{staticClass:"van-ellipsis"},[t._v(t._s(t.shopExplan.value?t.shopExplan.value:"请选择采购说明"))])]),t._v(" "),s("i",{staticClass:"van-icon van-icon-arrow van-cell__right-icon"})],1),t._v(" "),s("div",{staticClass:"van-cell van-field"},[s("div",{staticClass:"van-cell__title"},[t._v("成本价")]),t._v(" "),s("div",{staticClass:"van-cell__value"},[s("div",{staticClass:"van-field__body"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.goods.costPrice,expression:"goods.costPrice"}],staticClass:"van-field__control",attrs:{placeholder:"输入成本价",type:"digit",eventid:"6"},domProps:{value:t.goods.costPrice},on:{input:function(e){e.target.composing||(t.goods.costPrice=e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"van-cell van-field"},[s("div",{staticClass:"van-cell__title"},[t._v("利润")]),t._v(" "),s("div",{staticClass:"van-cell__value"},[s("div",{staticClass:"van-field__body"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.goods.profit,expression:"goods.profit"}],staticClass:"van-field__control",attrs:{placeholder:"输入利润",type:"digit",eventid:"7"},domProps:{value:t.goods.profit},on:{input:function(e){e.target.composing||(t.goods.profit=e.target.value)}}}),t._v(" "),s("div",{staticClass:"van-field__button"},[t._v("\n              售价: "),s("span",[t._v(t._s(t.sellPrice))])])])])])]),t._v(" "),s("div",{staticClass:"van-cell-group van-hairline--top-bottom"},[s("div",{staticClass:"van-cell van-cell--clickable",attrs:{eventid:"8"},on:{click:function(e){t.toOpen("showTime")}}},[t._m(0),t._v(" "),s("div",{staticClass:"van-cell__value"},[s("span",[t._v(t._s(t.goods.delivery?t.goods.delivery:"请选择货期排单"))])]),t._v(" "),s("i",{staticClass:"van-icon van-icon-arrow van-cell__right-icon"})],1),t._v(" "),s("div",{staticClass:"van-cell van-cell--clickable",attrs:{eventid:"9"},on:{click:function(e){t.toOpen("showType1")}}},[t._m(1),t._v(" "),s("div",{staticClass:"van-cell__value"},[s("span",[t._v(t._s(t.goods.labelInfo2?t.goods.labelInfo+"-"+t.goods.labelInfo2:"选择品类"))])]),t._v(" "),s("i",{staticClass:"van-icon van-icon-arrow van-cell__right-icon"})],1),t._v(" "),s("div",{staticClass:"van-cell van-cell--clickable",class:{"van-cell--sku":t.addShopType.length},attrs:{eventid:"11"},on:{click:t.handleTypeClick}},[t._m(2),t._v(" "),s("div",{staticClass:"van-cell__value"},[t.addShopType.length>0?s("div",{staticClass:"sku-items"},[t._l(t.addShopType,function(e,a){return s("div",{key:a,staticClass:"sku-item",style:{display:t.isLoadmore?"block":a>2?"none":"block"}},[t._v("\n              "+t._s(e.skuCode+"/"+e.stock)+"\n            ")])}),t._v(" "),t.addShopType.length>3?s("div",{staticClass:"sku-item__loadmore",attrs:{eventid:"10"},on:{click:function(e){e.stopPropagation(),t.handleLoadmoreClick(e)}}},[t._v(t._s(t.isLoadmore?"收起":"更多")+" "),s("i",{staticClass:"van-icon van-icon-arrow",class:{"van-cell__right-icon--down":t.isLoadmore}})],1):t._e()],2):s("div",[t._v("\n            点击选择规格与库存\n          ")])]),t._v(" "),s("i",{staticClass:"van-icon van-icon-arrow van-cell__right-icon"})],1),t._v(" "),t._l(t.type3Data,function(e,a){return s("div",{key:a,staticClass:"van-cell van-cell--clickable",attrs:{eventid:"12-"+a},on:{click:function(s){t.getNextLevlList(e.id,e.name,a)}}},[s("div",{staticClass:"van-cell__title"},[s("span",[t._v(t._s(e.name))])]),t._v(" "),s("div",{staticClass:"van-cell__value"},[s("span",[t._v(t._s(t.versionName[a]?t.versionName[a]:"点击选择"+e.name))])]),t._v(" "),s("i",{staticClass:"van-icon van-icon-arrow van-cell__right-icon"})],1)}),t._v(" "),s("div",{staticClass:"van-cell van-cell--clickable",attrs:{eventid:"13"},on:{click:function(e){t.toRoute("home/shopMgr/classify",{shopGroup:JSON.stringify(t.shopGroup)})}}},[t._m(3),t._v(" "),s("div",{staticClass:"van-cell__value"},[s("span",[t._v(t._s(t.shopGroup.groupText?t.shopGroup.groupText:"选择分组"))])]),t._v(" "),s("i",{staticClass:"van-icon van-icon-arrow van-cell__right-icon"})],1),t._v(" "),s("div",{staticClass:"van-cell van-cell--clickable",attrs:{eventid:"14"},on:{click:function(e){t.toOpen("showTag")}}},[t._m(4),t._v(" "),s("div",{staticClass:"van-cell__value",style:{textAlign:t.goods.tag?"left":"right"}},[s("span",[t._v(t._s(t.goods.tag?t.tagText:"选择标签"))])]),t._v(" "),s("i",{staticClass:"van-icon van-icon-arrow van-cell__right-icon"})],1),t._v(" "),s("div",{staticClass:"van-cell van-cell--clickable"},[t._m(5),t._v(" "),s("div",{staticClass:"van-cell__value"},[s("span",[s("div",{staticClass:"van-switch",class:{"van-switch--on":1===t.goods.isTransfer},staticStyle:{"font-size":"30px"},attrs:{eventid:"15"},on:{click:function(e){t.selectTransfer(0===t.goods.isTransfer?1:0)}}},[s("div",{staticClass:"van-switch__node"})])])])]),t._v(" "),s("div",{staticClass:"van-cell van-cell--clickable"},[t._m(6),t._v(" "),s("div",{staticClass:"van-cell__value"},[s("span",[s("div",{staticClass:"van-switch",class:{"van-switch--on":1===t.goods.isTop},staticStyle:{"font-size":"30px"},attrs:{eventid:"16"},on:{click:function(e){t.selectTop(0===t.goods.isTop?1:0)}}},[s("div",{staticClass:"van-switch__node"})])])])])],2),t._v(" "),s("div",{staticClass:"line-box"}),t._v(" "),s("div",{staticClass:"footer",attrs:{id:"footerContainer"}},[t.hasEditGoods?s("block",[s("p",{staticClass:"getUp",attrs:{eventid:"19"},on:{click:function(e){t.save(2)}}},[t._v("确认修改")])],1):s("block",[s("p",{staticClass:"getUp",attrs:{eventid:"17"},on:{click:function(e){t.save(1)}}},[t._v("立即上架")]),t._v(" "),s("p",{staticClass:"getIn",attrs:{eventid:"18"},on:{click:function(e){t.save(0)}}},[t._v("保存到仓库")])],1)],1),t._v(" "),t.showType1?s("div",{staticClass:"modal_box"},[s("div",{staticClass:"modal_time"},[s("div",{staticClass:"top"},[s("p",{staticClass:"cancel",attrs:{eventid:"20"},on:{click:function(e){t.toClose("showType1")}}},[t._v("取消")]),t._v(" "),s("p",{staticClass:"title"},[t._v(t._s(0===t.clickNum?"选择一级分类":"选择二级分类"))]),t._v(" "),0===t.clickNum?s("p",{staticClass:"confirm"}):s("p",{staticClass:"confirm",attrs:{eventid:"21"},on:{click:function(e){t.reSelect()}}},[t._v("重选")])],1),t._v(" "),0==t.clickNum?s("ul",{staticClass:"content"},t._l(t.type1Data,function(e,a){return s("li",{key:a,staticClass:"item",class:{active:t.type1Text.id==e.id},attrs:{eventid:"22-"+a},on:{click:function(s){t.confirmType("showType1",e)}}},[t._v(t._s(e.name)+"\n          ")])})):s("ul",{staticClass:"content"},t._l(t.type2Data,function(e,a){return 0!==t.clickNum?s("li",{key:a,staticClass:"item",class:[t.type2Text.id==e.id&&"active"],attrs:{eventid:"23-"+a},on:{click:function(s){t.toSelect("type2Text",e)}}},[t._v(t._s(e.name)+"\n          ")]):t._e()})),t._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:0!==t.clickNum,expression:"clickNum !== 0"}],staticClass:"ok",attrs:{eventid:"24"},on:{click:function(e){t.confirmType("showType2")}}},[t._v("确定")])],1)]):t._e(),t._v(" "),t.showTime?s("div",{staticClass:"modal_box"},[s("div",{staticClass:"modal_time"},[s("div",{staticClass:"top"},[s("p",{staticClass:"cancel",attrs:{eventid:"25"},on:{click:function(e){t.toClose("showTime")}}},[t._v("取消")]),t._v(" "),s("p",{staticClass:"title"},[t._v("选择货期排单")]),t._v(" "),s("p",{staticClass:"confirm",attrs:{eventid:"26"},on:{click:function(e){t.confirmOther("showTime")}}},[t._v("确定")])],1),t._v(" "),s("div",{staticClass:"content"},t._l(t.otherData,function(e,a){return 4==e.typeId?s("li",{key:a,staticClass:"item",class:{active:t.timeText.id==e.id},attrs:{eventid:"27-"+a},on:{click:function(s){t.select("timeText",e)}}},[t._v(t._s(e.name))]):t._e()}))])]):t._e(),t._v(" "),t._l(t.type3Data,function(e,a){return t.versionId===e.id?s("div",{key:a,staticClass:"modal_box"},[s("div",{staticClass:"modal_time"},[s("div",{staticClass:"top"},[s("p",{staticClass:"cancel",attrs:{eventid:"28-"+a},on:{click:function(s){t.closeVersion(e.id)}}},[t._v("取消")]),t._v(" "),s("p",{staticClass:"title"},[t._v("选择"+t._s(e.name))]),t._v(" "),s("p",{staticClass:"confirm",attrs:{eventid:"29-"+a},on:{click:function(e){t.selectName(t.type3Text,a)}}},[t._v("确定")])],1),t._v(" "),s("div",{staticClass:"content"},t._l(e.type4Data,function(i,o){return s("li",{key:a,staticClass:"item",class:{active:e.checkedId==i.id},attrs:{eventid:"30-"+a+"-"+o},on:{click:function(e){t.selectItem(i,a)}}},[t._v(t._s(i.name))])}))])]):t._e()}),t._v(" "),t.showTag?s("div",{staticClass:"modal_box"},[s("div",{staticClass:"modal_time"},[s("div",{staticClass:"top"},[s("p",{staticClass:"cancel",attrs:{eventid:"31"},on:{click:function(e){t.toClose("showTag")}}},[t._v("取消")]),t._v(" "),s("p",{staticClass:"title"},[t._v("选择商品标签")]),t._v(" "),s("p",{staticClass:"confirm",attrs:{eventid:"32"},on:{click:function(e){t.confirmOther("showTag")}}},[t._v("确定")])],1),t._v(" "),s("div",{staticClass:"content content_tag"},t._l(t.tagData,function(e,a){return s("div",{key:a,staticClass:"tag_item",attrs:{eventid:"33-"+a},on:{click:function(s){t.selectTagIds("tagIds",e)}}},[s("i",{staticClass:"select",class:e.select&&"select-active"}),t._v(" "),s("p",[t._v(t._s(e.name))])],1)})),t._v(" "),s("div",{staticClass:"add_line"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.addTagText,expression:"addTagText"}],staticClass:"add_input",attrs:{placeholder:"请输入",eventid:"34"},domProps:{value:t.addTagText},on:{input:function(e){e.target.composing||(t.addTagText=e.target.value)}}}),t._v(" "),s("p",{staticClass:"add_btn",attrs:{eventid:"35"},on:{click:t.addTag}},[t._v("添加")])],1)])]):t._e(),t._v(" "),t.showMarket?s("div",{staticClass:"modal_box"},[s("div",{staticClass:"modal_time"},[s("div",{staticClass:"top"},[s("p",{staticClass:"cancel",attrs:{eventid:"36"},on:{click:function(e){t.toClose("showMarket")}}},[t._v("取消")]),t._v(" "),s("p",{staticClass:"title"},[t._v("选择市场档口")]),t._v(" "),s("p",{staticClass:"confirm",attrs:{eventid:"37"},on:{click:function(e){t.confirmMarket()}}},[t._v("确定")])],1),t._v(" "),s("div",{staticClass:"box-select"},[s("div",{staticClass:"s_item first"},t._l(t.mktFirstData,function(e,a){return s("p",{key:a,class:[t.selectFMarket.id==e.id&&"active"],attrs:{eventid:"38-"+a},on:{click:function(s){t.getMarketData(1,e)}}},[t._v(t._s(e.name))])})),t._v(" "),s("div",{staticClass:"s_item second"},t._l(t.mktSecondData,function(e,a){return s("p",{key:a,class:[t.selectSMarket.id==e.id&&t.selectSMarket.id&&"active"],attrs:{eventid:"39-"+a},on:{click:function(s){t.getMarketData(2,e)}}},[t._v(t._s(e.name))])})),t._v(" "),s("div",{staticClass:"s_item third"},t._l(t.mktThirdData,function(e,a){return s("p",{key:a,class:[t.selectTMarket.id&&t.selectTMarket.id==e.id&&"active"],attrs:{eventid:"40-"+a},on:{click:function(s){t.confirmMarket(e)}}},[t._v(t._s(e.name))])}))])])]):t._e(),t._v(" "),s("i-message",{attrs:{id:"message",mpcomid:"0"}}),t._v(" "),s("view",{directives:[{name:"show",rawName:"v-show",value:t.showProgress,expression:"showProgress"}],staticClass:"progress-item"},[s("i-progress",{attrs:{percent:t.progressValue,"hide-info":"",mpcomid:"1"}})],1),t._v(" "),s("i-modal",{attrs:{visible:t.topTips,eventid:"41",mpcomid:"2"},on:{ok:function(e){t.setTop("topTips")},cancel:function(e){t.toClose("topTips")}}},[s("div",{staticClass:"m_tips"},[t._v("已有置顶商品，是否更换置顶商品？")])])],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"van-cell__title"},[e("span",[this._v("货期排单")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"van-cell__title"},[e("span",[this._v("品类")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"van-cell__title"},[e("span",[this._v("规格与库存")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"van-cell__title"},[e("span",[this._v("商品分组")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"van-cell__title"},[e("span",[this._v("商品标签")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"van-cell__title"},[e("span",[this._v("支持转售")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"van-cell__title"},[e("span",[this._v("置顶")])])}]};e.a=a},wAH5:function(t,e,s){"use strict";var a=s("ifoU"),i=s.n(a),o=s("Gu7T"),n=s.n(o),l=s("//Fk"),c=s.n(l),r=s("fZjL"),d=s.n(r),v=s("Xxa5"),u=s.n(v),p=s("woOf"),g=s.n(p),_=s("exGp"),f=s.n(_),m=s("Dd8w"),h=s.n(m),T=s("qTHA"),k=s("90m7"),C=s("QmSG"),y=s("0xDb"),I=(s.n(y),s("NYxO"));e.a={mixins:[k.a],components:{},data:function(){return{footerContainerHeight:0,isLoadmore:!1,topTips:!1,isTopBool:!1,showProgress:!1,progressValue:0,videoSrc:"",uploadNum:9,maxNum:15,imgStr:"",imgList:[],versionId:"",versionName:[],clickNum:0,editType:!1,showTime:!1,showType:!1,showTag:!1,sellType:!0,showMarket:!1,showType0:!1,showType1:!1,showType2:!1,showType3:!1,type1Data:[],type2Data:[],type3Data:[],type4Data:[],tagIds:"",tagText:"",type0Text:"",type1Text:"",type2Text:"",type3Text:"",type4Text:"",timeText:{},imageList:[],selectFMarket:"",selectSMarket:"",selectTMarket:"",mktFirstData:{},mktSecondData:{},mktThirdData:{},marketText:"",otherData:[],otherData2:[],groupData:[],groupVal:"",addTagText:"",tagData:"",goods:{isTop:0,name:"",stallInfo1:"",stallInfo2:"",stallInfo3:"",labelInfo:"",labelInfo2:"",labelInfo3:"",labelIds:"",deliveryId:"",delivery:"",isTransfer:1,images:"",video:"",content:"",costPrice:"",profit:"",groupIds:"",tag:"",buyExplan:""},skuList:[],hasEditGoods:!1,goodsLabelValueIds:[],postLabelInfo:[],postLabelInfo2:[],groupValue:[]}},computed:h()({sellPrice:function(){return this.goods.costPrice&&this.goods.profit?(this.goods.sellPrice=(Number(this.goods.costPrice)+Number(this.goods.profit)).toFixed(2),this.goods.sellPrice+"元"):"0.00元"}},Object(I.b)(["addShopType","shopGroup","shopExplan"])),mounted:function(){var t=this;return f()(u.a.mark(function e(){var s,a,i,o,n,l,c,r,d,v,p,_,f,m,h,k,C,y;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.$route.query.shopId,t.hasEditGoods=!!s,T.a.setNavigationBarTitle({title:s?"编辑商品":"添加商品"}),e.next=5,t.$API.searchType({types:"1,2,3,4"});case 5:if(a=e.sent,i=a.data,console.log(i),t.otherData=i,t.type1Data=i.filter(function(t){return 2===parseInt(t.typeId)}),t.getMarketData(0),!s){e.next=69;break}return e.next=14,t.$API.L_selectGoodsDetail({goodsId:t.$route.query.shopId});case 14:return o=e.sent,t.$store.commit("ADD_GOODS_DETAIL",o.data),[],(n=o.data.goodsLabel).forEach(function(e,s){t.versionName[s]=e.labelValue,t.goodsLabelValueIds.push(e.labelVId)}),(l=o.data.sku.skuList).forEach(function(t){[].push({skuCode:t.skuCode,stock:t.stock,image:t.image,attrIds:t.attrIds})}),t.$store.commit("ADDSHOPTYPE",l),t.videoSrc=o.data.video,t.imageList=o.data.images.split(",").filter(function(t){return!!t}).concat(o.data.content.split(",").filter(function(t){return!!t})),t.goods.state=o.data.state,t.goods.name=o.data.name,t.goods.stallInfo1=o.data.stallInfo1,t.goods.stallInfo2=o.data.stallInfo2,t.goods.stallInfo3=o.data.stallInfo3,t.goods.content=o.data.content,t.goods.delivery=o.data.delivery,t.goods.labelInfo=o.data.labelInfo,t.goods.labelInfo2=o.data.labelInfo2,t.goods.labelInfo3=o.data.labelInfo3,t.goods.deliveryId=o.data.deliveryId,t.goods.labelIds=o.data.labelIds,t.goods.buyExplan=o.data.buyExplan,t.goods.buyExplanId=o.data.buyExplanId,t.goods.tag=o.data.tag,t.tagIds=o.data.tag,t.goods.id=s,o.data.tagsList&&(c=o.data.tagsList,r=[],d=[],c.forEach(function(t){r.push(t.id),d.push(t.name)}),t.goods.tag=r.toString(),t.tagIds=r.toString(),t.tagText=d.toString()),t.clickNum=1,o.data.labelList.forEach(function(e,s){t["type"+(s+1)+"Text"]=e}),e.next=46,t.getShopClass(2,t.type1Text.id);case 46:return v=e.sent,p=v.data,t.type2Data=p,e.next=51,t.getShopClass(2,t.type2Text.id);case 51:_=e.sent,f=_.data,console.log(n),t.type3Data=f.map(function(t,e){return n[e]&&(t.selectedId=n[e].labelVId),t}),t.groupValue=o.data.groupList,t.goods.profit=o.data.profit,t.goods.costPrice=o.data.costPrice,t.$store.commit("ADDSHOPEXPLAN",{value:o.data.buyExplan,id:o.data.buyExplanId}),m=[],h=[],o.data.groupList.forEach(function(t){m.push(t.id),h.push(t.name)}),t.$store.commit("ADDSHOPGROUP",{groupIds:m.join(","),groupText:h.join(",")}),t.$set(t.goods,"isTransfer",o.data.isTransfer),t.$set(t.goods,"isTop",o.data.isTop),t.$route.query.id&&(t.editType=!0,t.goods=t.$route.query),i.filter(function(t){return 4==t.typeId}).some(function(e){if(e.id===t.goods.deliveryId)return t.timeText=g()({},e),!0}),e.next=77;break;case 69:i.filter(function(t){return 1==t.typeId}).some(function(e){return t.$store.commit("ADDSHOPGROUP",{groupIds:e.id,groupText:e.name}),!0}),t.$store.commit("ADDSHOPTYPE",[]),t.$store.commit("ADDSHOPEXPLAN",{}),t.$store.commit("ADD_GOODS_DETAIL",{}),t.goods.video="",t.goods.imageList=[],t.goods.images="",t.imgList=[];case 77:for(k=[],t.tagText="",t.tagIds="",C=0;y=t.otherData[C++];)3==y.typeId&&(t.goods.tag&&t.goods.tag.split(",").indexOf(y.id)>=0?(y.select=!0,t.tagText+=y.name+",",t.tagIds+=y.id+","):y.select=!1,k.push(y));t.tagData=k;case 82:case"end":return e.stop()}},e,t)}))()},onUnload:function(){g()(this,this.$options.data())},methods:{handleLoadmoreClick:function(){this.isLoadmore=!this.isLoadmore},handleTypeClick:function(){this.$router.push({path:"/pages/home/addShop/addType",query:{goodsId:this.$route.query.shopId}})},setTop:function(t){this[t]=!1,this.setData({isTopBool:!0}),this.goods.isTop=1},selectTop:function(t){var e=this;this.$API.selectTopGoods().then(function(s){s.data?e.topTips=!0:(console.log(t),e.$set(e.goods,"isTop",t))})},onChange:function(t){var e=this,s=t.mp.detail;0==this.isTopBool?this.$API.selectTopGoods().then(function(t){t.data&&(e.topTips=!0)}):1==this.isTopBool&&(this.setData({isTopBool:s.value}),this.goods.isTop=0,console.log(this.goods.isTop))},setData:function(t){var e=this;d()(t).forEach(function(s){e[s]=t[s]})},toSelect:function(t,e){this[t]=e,this.clickNum=2},uploadImg:function(t){var e=this;return new c.a(function(s){var a=t.lastIndexOf("/")+1,i=e;T.a.uploadFile({url:C.a.uploadImageUrl,filePath:t,name:"file",formData:{name:t.slice(a).toString(),key:"img/${filename}",policy:C.a.imgPolicy,OSSAccessKeyId:C.a.OSSAccessKeyId,success_action_status:"200",signature:C.a.imgSignature},success:function(e){400==parseInt(e.statusCode)?i.handleError("上传的图片大小不能超过2m!"):200==parseInt(e.statusCode)&&s(C.a.uploadImageUrl+"/img/"+t.slice(a).toString())},fail:function(t){reject()}})})},bindButtonTapImage:function(){this.maxNum;var t=this;T.a.chooseImage({sizeType:"original",count:15-this.imageList.length,success:function(e){var s=[];e.tempFilePaths.forEach(function(e){s.push(t.uploadImg(e))}),T.a.showLoading({title:"上传中"}),c.a.all(s).then(function(e){var s;(s=t.imageList).push.apply(s,n()(e))}).catch(function(t){T.a.showToast({title:"网络出错",icon:"none"})}).finally(function(){T.a.hideLoading()})},fail:function(){},complete:function(){}})},handleError:function(t){this.$Message({content:t,type:"error"})},toCancel:function(t){this.imageList.splice(t,1),console.log("this.imageList =========>",this.imageList)},bindButtonTap:function(){var t=this;T.a.showLoading(),console.log(111);var e=this;T.a.chooseVideo({sourceType:["album","camera"],maxDuration:60,camera:["front","back"],success:function(t){var s=this;console.log(t);var a=t.tempFilePath,i=a.lastIndexOf("/")+1,o=T.a.uploadFile({url:C.a.uploadImageUrl,filePath:a,name:"file",formData:{name:a.slice(i).toString(),key:"video/${filename}",policy:C.a.videoPolicy,OSSAccessKeyId:C.a.OSSAccessKeyId,success_action_status:"200",signature:C.a.videoSignature},success:function(t){console.log(t),400==t.statusCode?e.handleError("上传的视频大小不能超过20m!"):200==t.statusCode&&(e.videoSrc=C.a.uploadImageUrl+"/video/"+a.slice(i).toString(),e.getVideo(e.videoSrc))},fail:function(t){s.handleError("上传失败，错误原因： "+t.errMsg),console.log(t)}});e.toggleProgress(),o.onProgressUpdate(function(t){console.log(t.progress),e.progressValue=t.progress,100===e.progressValue&&(e.toggleProgress(),T.a.showToast({title:"上传完成"}),e.progressValue=0)})},fail:function(e){t.handleError("上传失败，错误原因： "+e.errMsg),console.log(e)},complete:function(){T.a.hideLoading()}})},closeVersion:function(t){this.versionId=0},getNextLevlList:function(t,e,s){var a=this;return f()(u.a.mark(function i(){var o,n;return u.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a.versionId=t,i.next=3,a.getShopClass(2,t);case 3:o=i.sent,n=o.data,a.$set(a.type3Data[s],"type4Data",n),a.type3Data[s].selectedId&&a.$set(a.type3Data[s],"checkedId",a.type3Data[s].selectedId),a.postLabelInfo2[s]=e;case 9:case"end":return i.stop()}},i,a)}))()},selectItem:function(t,e){console.log(t),this.select("type3Text",t),this.$set(this.type3Data[e],"checkedId",t.id)},selectName:function(t,e){console.log("name"+t.name),this.versionName[e]=t.name,this.goodsLabelValueIds[e]=t.id,this.$set(this.type3Data[e],"selectedId",t.id),this.closeVersion(t.id)},reSelect:function(){this.clickNum=0},save:function(t){var e=this;return f()(u.a.mark(function s(){var a,o,n,l,c,r,d,v,p,g,_;return u.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(T.a.getStorage({key:"production_sessionId",success:function(t){console.log(t,"res")}}),e.imageList.length>0&&(e.goods.image=e.imageList[0],e.goods.images=e.imageList.slice(0,3).join(",")),e.imageList.length>3&&(e.goods.content=e.imageList.slice(3).join(",")),a=[],e.type1Text.id&&(a.push(e.type1Text),e.goods.labelIds=e.type1Text.id+","),e.type2Text.id&&(a.push(e.type2Text),e.goods.labelIds+=e.type2Text.id+",",console.log("this.goods.labelIds=>"+e.goods.labelIds)),e.type3Text.id&&(a.push(e.type3Text),e.goods.labelIds+=e.type3Text.id+","),e.goods.groupIds=e.shopGroup.groupIds,e.goods.buyExplanId=e.shopExplan.id,o=T.a.getAccountInfoSync(),n=o.miniProgram.appId,(l={goodsLabelValueIds:e.goodsLabelValueIds.toString(),goods:h()({},e.goods,{video:e.videoSrc,state:e.hasEditGoods?e.goods.state:t}),skuList:e.addShopType,shopId:n}).name=e.name,l.labelInfo=e.goods.labelInfo,l.labelInfo2=[e.goods.labelInfo2].concat(e.versionName).concat(e.postLabelInfo2).join(","),l.labelInfo3=e.versionName.toString(),l.isTop=e.isTop,l.skuList.length>0){for(c=function(t){var e=new i.a;return t.filter(function(t){return!e.has(t)&&e.set(t,1)})},r="",d=0;v=l.skuList[d++];)r+=v.attrIds+",";console.log(r),p=r.split(","),console.log(p),p=c(p),l.attrIds=p.filter(function(t){return!!t}).join(",")}if(0!=t){s.next=21;break}s.next=27;break;case 21:if(console.log(e.goods.images),g=[{name:e.goods.images,errMsg:"至少添加一张图片！"},{name:e.goods.name,errMsg:"商品标题"},{name:e.goods.stallInfo1,errMsg:"市场档口"},{name:e.goods.costPrice,errMsg:"成本价"},{name:e.goods.profit,errMsg:"利润价"},{name:e.goods.deliveryId,errMsg:"货期排单"},{name:e.goods.labelIds,errMsg:"商品分类"}],!(_=e.$check.all(g))){s.next=27;break}return e.handleError(_),s.abrupt("return");case 27:if(console.log(l),2!=t){s.next=34;break}return s.next=31,e.$API.editShop(l);case 31:e.$success("修改成功！"),s.next=37;break;case 34:return s.next=36,e.$API.addShop(l);case 36:e.$success("添加成功！");case 37:setTimeout(function(){T.a.setStorageSync("is-update-goods",!0),e.$router.back(-1)},2e3);case 38:case"end":return s.stop()}},s,e)}))()},selectTagIds:function(t,e){var s=e.id;e.select=!e.select,this[t].split(",").indexOf(s)>=0?(this[t]=this[t].replace(s+",",""),this.tagText=this.tagText.replace(e.name+",","")):(this[t]+=s+",",this.tagText+=e.name+","),console.log(this[t]),console.log("选择后的tagdata ===========> ",this.tagData)},addTag:function(){var t=this;return f()(u.a.mark(function e(){var s,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.addTagText){e.next=2;break}return e.abrupt("return",t.handleError("请输入标签！"));case 2:return e.next=4,t.$API.addShopTag({name:t.addTagText});case 4:s=e.sent,a=s.data,t.addTagText="",a.select=!1,t.tagData.push(a);case 9:case"end":return e.stop()}},e,t)}))()},confirmType:function(t,e){var s=this;return f()(u.a.mark(function a(){var i,o,n,l;return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if("showType1"!=t){a.next=16;break}if(s.postLabelInfo2=[],s.versionName=[],s.select("type1Text",e),s.clickNum=1,s.type1Text.id){a.next=7;break}return a.abrupt("return");case 7:return s.goods.labelInfo=s.type1Text.name,console.log("this.goods.labelInfo"+s.goods.labelInfo),a.next=11,s.getShopClass(2,s.type1Text.id);case 11:i=a.sent,o=i.data,console.log(o),s.type2Data=o,s.type3Data=[];case 16:if("showType2"!=t){a.next=32;break}if(2===s.clickNum){a.next=20;break}return s.handleError("未选择二级分类"),a.abrupt("return");case 20:if(s.postLabelInfo2=[],s.versionName=[],s.toClose("showType1"),s.type2Text.id){a.next=25;break}return a.abrupt("return");case 25:return s.goods.labelInfo2=s.type2Text.name,console.log("this.goods.labelInfo2"+s.goods.labelInfo2),a.next=29,s.getShopClass(2,s.type2Text.id);case 29:n=a.sent,l=n.data,s.type3Data=l;case 32:case"end":return a.stop()}},a,s)}))()},confirmOther:function(t){if(this.toClose(t),"showTime"==t){if(!this.timeText.id)return;this.goods.deliveryId=this.timeText.id,this.goods.delivery=this.timeText.name}if("showTag"==t){if(!this.tagIds)return;this.goods.tag=this.tagIds}},confirmMarket:function(t){if(t)return this.selectTMarket=t;this.goods.stallInfo1=this.selectFMarket.name,this.goods.stallInfo2=this.selectSMarket.name,this.goods.stallInfo3=this.selectTMarket.name,this.marketText=this.selectFMarket.name+"-"+this.selectSMarket.name+"-"+this.selectTMarket.name,this.toClose("showMarket")},selectTime:function(t){this.timeText=t},getVideo:function(t){this.goods.video=t},getImg:function(t){this.imageList.push(t),console.log("imageList ===> ",this.imageList)},toggleProgress:function(){this.showProgress=!this.showProgress},getMarketData:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return f()(u.a.mark(function a(){var i,o,n;return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return(i=s.id||"")&&(1==t&&(e.selectFMarket=s),2==t&&(e.selectSMarket=s)),0==t&&(e.mktSecondData={},e.mktThirdData={}),1==t&&(e.mktThirdData={}),a.next=6,e.$API.searchMarket({series:t,pid:i});case 6:o=a.sent,0==(n=o.data).length&&(n=[{id:"",name:"无",isno:!1}]),0==t&&(e.mktFirstData=n),1==t&&(e.mktSecondData=n),2==t&&(e.mktThirdData=n);case 12:case"end":return a.stop()}},a,e)}))()},getShopClass:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.$API.searchType({types:t,pId:e})},selectTransfer:function(t){this.$set(this.goods,"isTransfer",t)}}}}},["mFjA"]);