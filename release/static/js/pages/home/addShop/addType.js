global.webpackJsonp([65],{"+8J8":function(t,s,i){"use strict";var e=i("woOf"),n=i.n(e),a=i("Xxa5"),o=i.n(a),c=i("exGp"),l=i.n(c),r=i("Dd8w"),u=i.n(r),d=i("qTHA"),v=i("Vk0E"),m=i("cyB7"),p=i("90m7"),f=i("QmSG"),g=i("NYxO");s.a={mixins:[p.a],components:{ibox:v.a,btn:m.a},data:function(){return{typeText:"",colorText:"",showColor:!1,showTag:!1,selectColor:[],selectTag:[],imgList:[],lineList:[],colorArr:[],typeArr:[]}},computed:u()({},Object(g.b)(["goodsDetail"]),{selColor:function(){return this.selectColor.join(",")},selTag:function(){return this.selectTag.join(",")}}),methods:{comfirmType:function(t){if(this.toClose(t),"showColor"==t){for(var s=[],i=0;e=this.colorArr[i++];)e.select&&s.push(e.name);this.selectColor=s}if("showTag"==t){var e,n=[];for(i=0;e=this.typeArr[i++];)e.select&&n.push(e.name);this.selectTag=n}this.addLine()},selects:function(t,s){this.$set(this[s][t],"select",!this[s][t].select)},addLine:function(){if(this.selectColor.length>0&&this.selectTag.length>0){for(var t,s=[],i=[],e=0;t=this.selectColor[e++];)for(var n,a=0;n=this.selectTag[a++];){var o={id:String(e)+String(a),img:""};s.push(o);var c={id:String(e)+String(a),color:t,tag:n,num:100};i.push(c)}this.imgList=s,this.lineList=i}},delLine:function(t){this.lineList.splice(t,1),this.imgList.splice(t,1)},bindButtonTap:function(t){d.a.showLoading();var s=this;d.a.chooseImage({sizeType:"original",count:1,success:function(i){console.log(i);var e=i.tempFilePaths;console.log(e);for(var n,a=0;n=e[a++];)s.uploadImg(n,t)},complete:function(){d.a.hideLoading()}})},toCancel:function(t){this.$set(this.imgList[t],"img","")},uploadImg:function(t,s){var i=this,e=t.lastIndexOf("/")+1;console.log(t.slice(e).toString()),d.a.uploadFile({url:f.a.uploadImageUrl,filePath:t,name:"file",formData:{name:t.slice(e).toString(),key:"img/${filename}",policy:f.a.imgPolicy,OSSAccessKeyId:f.a.OSSAccessKeyId,success_action_status:"200",signature:f.a.imgSignature},success:function(n){if(console.log(n),400==n.statusCode)i.handleError("上传的图片大小不能超过2m!");else if(200==n.statusCode){var a=f.a.uploadImageUrl+"/img/"+t.slice(e).toString();i.$set(i.imgList[s],"img",a)}},fail:function(t){console.log(t)}})},confirm:function(){for(var t,s=this,i=function(t){for(var i,e=0;i=s.colorArr[e++];)if(t==i.name)return i.id},e=function(t){for(var i,e=0;i=s.typeArr[e++];)if(t==i.name)return i.id},n=[],a=0;t=this.imgList[a++];){var o={skuCode:this.lineList[a-1].color+","+this.lineList[a-1].tag,stock:this.lineList[a-1].num,image:t.img,attrIds:i(this.lineList[a-1].color)+","+e(this.lineList[a-1].tag)};n.push(o)}this.$store.commit("ADDSHOPTYPE",n),this.$router.back(-1)}},mounted:function(){var t=this;return l()(o.a.mark(function s(){var i,e,n,a,c,l,r,d,v,m;return o.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,(i=t.goodsDetail)&&i.sku&&(e=i.sku,n=[],a=[],e.skuList.forEach(function(t,s){console.log(t),n[s]=u()({},t,{img:t.image}),a[s]=u()({},t,{color:t.skuCode.split(",")[0],tag:t.skuCode.split(",")[1],num:t.stock})}),t.imgList=n,t.lineList=a,e.specGroup.forEach(function(s){var i=void 0;switch(s.enValue){case"color":i="selectColor";break;case"size":i="selectTag"}i&&(t[i]=s.specAttr.map(function(t){return t.name}))})),s.next=5,t.$API.s_searchType({specId:1});case 5:for(c=s.sent,l=0;r=c.data[l++];)r.select=!1;return s.next=9,t.$API.s_searchType({specId:2});case 9:for(d=s.sent,v=0;m=d.data[v++];)m.select=!1;t.colorArr=c.data.map(function(t){return i&&i.sku&&-1!==i.sku.specGroup[0].specAttr.findIndex(function(s){return s.id===t.id})&&(t.select=!0),t}),t.typeArr=d.data.map(function(t){return i&&i.sku&&-1!==i.sku.specGroup[1].specAttr.findIndex(function(s){return s.id===t.id})&&(t.select=!0),t}),s.next=18;break;case 15:s.prev=15,s.t0=s.catch(0),console.log(s.t0);case 18:case"end":return s.stop()}},s,t,[[0,15]])}))()},onUnload:function(){n()(this,this.$options.data())}}},"2srT":function(t,s){},AvjR:function(t,s,i){"use strict";var e=i("+8J8"),n=i("T+iw");var a=function(t){i("2srT")},o=i("ybqe")(e.a,n.a,a,"data-v-21c5fb26",null);s.a=o.exports},"T+iw":function(t,s,i){"use strict";var e={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"home"},[i("div",{staticClass:"box_content"},[i("div",{staticClass:"line b_line",attrs:{eventid:"0"},on:{click:function(s){t.toOpen("showColor")}}},[i("p",{staticClass:"input"},[t._v("颜色：")]),t._v(" "),i("p",{staticClass:"blur"},[t._v(t._s(t.selectColor.length>0?t.selColor:"点击选择颜色"))])],1),t._v(" "),i("div",{staticClass:"line b_line",attrs:{eventid:"1"},on:{click:function(s){t.toOpen("showTag")}}},[i("p",{staticClass:"input"},[t._v("尺码：")]),t._v(" "),i("p",{staticClass:"blur"},[t._v(t._s(t.selectTag.length>0?t.selTag:"点击选择尺码"))])],1)]),t._v(" "),i("div",{staticClass:"add_video"},[i("div",{staticClass:"v_box"},t._l(t.imgList,function(s,e){return i("div",{key:e},[i("div",{staticClass:"add_videos"},[s.img?i("div",{staticClass:"add img_list "},[i("img",{staticClass:"item_img",attrs:{src:s.img}}),t._v(" "),i("i",{staticClass:"cancel_shop",attrs:{eventid:"2-"+e},on:{click:function(s){t.toCancel(e)}}}),t._v(" "),i("div",{staticClass:"tips_bg"},[t._v(t._s(t.lineList[e].color+" "+t.lineList[e].tag))])],1):i("div",{staticClass:"add add_box"},[i("div",[i("p",{attrs:{eventid:"3-"+e},on:{tap:function(s){t.bindButtonTap(e)}}},[t._v(t._s(t.lineList[e].color+" "+t.lineList[e].tag))])],1)])])])}))]),t._v(" "),i("div",{staticClass:"line_box"},t._l(t.lineList,function(s,e){return i("div",{key:e,staticClass:"add_line b_line"},[i("p",[t._v(t._s(s.color))]),t._v(" "),i("p",[t._v(t._s(s.tag))]),t._v(" "),i("p",{staticClass:"num"},[i("input",{directives:[{name:"model",rawName:"v-model",value:s.num,expression:"item.num"}],staticClass:"input_num",attrs:{min:"0",eventid:"4-"+e},domProps:{value:s.num},on:{input:function(t){t.target.composing||(s.num=t.target.value)}}})]),t._v(" "),i("p",{staticClass:"del",attrs:{eventid:"5-"+e},on:{click:function(s){t.delLine(e)}}},[t._v("删除")])],1)})),t._v(" "),t.showColor?i("div",{staticClass:"modal_box"},[i("div",{staticClass:"modal_time"},[i("div",{staticClass:"top"},[i("p",{staticClass:"cancel",attrs:{eventid:"6"},on:{click:function(s){t.toClose("showColor")}}},[t._v("取消")]),t._v(" "),i("p",{staticClass:"title"},[t._v("选择颜色")]),t._v(" "),i("p",{staticClass:"confirm",attrs:{eventid:"7"},on:{click:function(s){t.comfirmType("showColor")}}},[t._v("确定")])],1),t._v(" "),i("div",{staticClass:"content content_tag"},t._l(t.colorArr,function(s,e){return i("div",{key:e,staticClass:"tag_item",attrs:{eventid:"8-"+e},on:{click:function(s){t.selects(e,"colorArr")}}},[i("i",{staticClass:"select",class:[s.select&&"select-active"]}),t._v(" "),i("p",[t._v(t._s(s.name))])],1)}))])]):t._e(),t._v(" "),t.showTag?i("div",{staticClass:"modal_box"},[i("div",{staticClass:"modal_time"},[i("div",{staticClass:"top"},[i("p",{staticClass:"cancel",attrs:{eventid:"9"},on:{click:function(s){t.toClose("showTag")}}},[t._v("取消")]),t._v(" "),i("p",{staticClass:"title"},[t._v("选择尺码")]),t._v(" "),i("p",{staticClass:"confirm",attrs:{eventid:"10"},on:{click:function(s){t.comfirmType("showTag")}}},[t._v("确定")])],1),t._v(" "),i("div",{staticClass:"content content_tag"},t._l(t.typeArr,function(s,e){return i("div",{key:e,staticClass:"tag_item",attrs:{eventid:"11-"+e},on:{click:function(s){t.selects(e,"typeArr")}}},[i("i",{staticClass:"select",class:{"select-active":s.select}}),t._v(" "),i("p",[t._v(t._s(s.name))])],1)}))])]):t._e(),t._v(" "),i("div",{staticClass:"bottom"}),t._v(" "),i("div",{staticClass:"create"},[i("p",{attrs:{eventid:"12"},on:{click:t.confirm}},[t._v("确定")])],1)])},staticRenderFns:[]};s.a=e}},["uCWr"]);